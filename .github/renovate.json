{
  "extends": [
    "config:best-practices",
    ":gitSignOff",
    ":rebaseStalePrs",
    "group:allNonMajor",
    "docker:disableMajor",
    "default:pinDigestsDisabled"
  ],
  "labels": [
    "kind/dependency upgrade"
  ],
  "baseBranches": [
    "main",
    "/^1\\..*\\.x/"
  ],
  "constraints": {
    "go": "1.20"
  },
  "packageRules": [
    {
      "description": "Do NOT generate PRs to pin or apply digests to dockerfiles",
      "enabled": false,
      "matchDatasources": [
        "docker"
      ],
      "matchUpdateTypes": [
        "pin","pinDigest", "digest"
      ],
      "automerge": false
    },
    {
      "description": "Do automerge patch updates to dockerfiles",
      "enabled": true,
      "matchDatasources": [
        "docker"
      ],
      "matchUpdateTypes": [
        "patch"
      ],
      "automerge": true,
      "pinDigests": false
    },
    {
      "description": "k8s, ginkgo, gomega: minor and patch updates in main",
      "enabled": true,
      "groupName": "kubernetes packages main",
      "groupSlug": "kubernetes-go",
      "matchDatasources": [
        "go"
      ],
      "matchPackagePrefixes": [
        "k8s.io/api",
        "k8s.io/apiextensions-apiserver",
        "k8s.io/apimachinery",
        "k8s.io/apiserver",
        "k8s.io/cli-runtime",
        "k8s.io/client-go",
        "k8s.io/cloud-provider",
        "k8s.io/cluster-bootstrap",
        "k8s.io/code-generator",
        "k8s.io/component-base",
        "k8s.io/controller-manager",
        "k8s.io/cri-api",
        "k8s.io/csi-translation-lib",
        "k8s.io/kube-aggregator",
        "k8s.io/kube-controller-manager",
        "k8s.io/kube-proxy",
        "k8s.io/kube-scheduler",
        "k8s.io/kubectl",
        "k8s.io/kubelet",
        "k8s.io/legacy-cloud-providers",
        "k8s.io/metrics",
        "k8s.io/mount-utils",
        "k8s.io/pod-security-admission",
        "k8s.io/sample-apiserver",
        "k8s.io/sample-cli-plugin",
        "k8s.io/sample-controller",
        "github.com/onsi/ginkgo/v2",
	      "github.com/onsi/gomega"
      ],
      "matchUpdateTypes": [
        "minor", "patch"
      ],
      "baseBranches": [
        "main"
      ],
      "automerge": false
    },
    {
      "description": "k8s, ginkgo, gomega: patch updates only in 1.*.x",
      "enabled": true,
      "groupName": "kubernetes packages 1.*.x",
      "groupSlug": "kubernetes-go",
      "matchDatasources": [
        "go"
      ],
      "matchPackagePrefixes": [
        "k8s.io/api",
        "k8s.io/apiextensions-apiserver",
        "k8s.io/apimachinery",
        "k8s.io/apiserver",
        "k8s.io/cli-runtime",
        "k8s.io/client-go",
        "k8s.io/cloud-provider",
        "k8s.io/cluster-bootstrap",
        "k8s.io/code-generator",
        "k8s.io/component-base",
        "k8s.io/controller-manager",
        "k8s.io/cri-api",
        "k8s.io/csi-translation-lib",
        "k8s.io/kube-aggregator",
        "k8s.io/kube-controller-manager",
        "k8s.io/kube-proxy",
        "k8s.io/kube-scheduler",
        "k8s.io/kubectl",
        "k8s.io/kubelet",
        "k8s.io/legacy-cloud-providers",
        "k8s.io/metrics",
        "k8s.io/mount-utils",
        "k8s.io/pod-security-admission",
        "k8s.io/sample-apiserver",
        "k8s.io/sample-cli-plugin",
        "k8s.io/sample-controller",
        "github.com/onsi/ginkgo/v2",
	      "github.com/onsi/gomega"
      ],
      "matchUpdateTypes": [
        "patch"
      ],
      "baseBranches": [
        "/^1\\..*\\.x/"
      ],
      "automerge": false
    },
    {
      "description": "Do NOT generate PRs for major go dependency updates ",
      "enabled": false,
      "matchDatasources": [
        "go"
      ],
      "matchUpdateTypes": [
        "major"
      ],
      "automerge": false
    },
    {
      "description": "Do automerge go dependency patch updates, except for versions starting with 0",
      "enabled": true,
      "matchDatasources": [
        "go"
      ],
      "matchUpdateTypes": [
        "patch"
      ],
      "matchCurrentVersion": "!/^0/",
      "automerge": true
    },
    {
      "description": "Do generate PRs for golang version patch bumps, keeping x.yy version the same",
      "enabled": true,
      "matchDatasources": [
        "golang-version"
      ],
      "matchUpdateTypes": [
        "patch"
      ],
      "rangeStrategy": "bump",
      "automerge": false
    }
  ],
  "vulnerabilityAlerts": {
    "enabled": true,
    "addLabels": [
      "kind/security"
    ]
  },
  "osvVulnerabilityAlerts": true
}
